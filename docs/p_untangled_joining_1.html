<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>21&nbsp; Introduction to Joining Datasets – Introduction to Data Science with Python</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./p_untangled_joining_2.html" rel="next">
<link href="./p_untangled_other_grouped_operations.html" rel="prev">
<link href="./logo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./p_untangled_subset_columns.html">Data Manipulation</a></li><li class="breadcrumb-item"><a href="./p_untangled_joining_1.html"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Introduction to Joining Datasets</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Data Science with Python</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/the-graph-courses/idap_book" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">介绍</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_foundations_google_colab.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to Google Colab</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_foundations_coding_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Coding basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_foundations_functions_methods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Functions, Methods, and Libraries in Python</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_foundations_data_structures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Structures in Python</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_foundations_for_loops.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Intro to Loops in Python</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_foundations_writing_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Intro to Functions and Conditionals</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Data Visualization</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_data_on_display_data_viz_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data Visualization Types</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_data_on_display_univariate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Univariate Graphs with Plotly Express</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_data_on_display_multivariate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Bivariate &amp; Multivariate Graphs with Plotly Express</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Tools for Local Python</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_tools_installing_python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Installing Python</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_tools_using_vscode.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Installing and Using VS Code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_tools_venv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Folders and Virtual Environments</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_tools_quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Using Quarto</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Data Manipulation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_untangled_subset_columns.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Subsetting columns</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_untangled_query_rows.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Querying rows</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_untangled_transform_variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Transforming Variables in pandas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_untangled_conditional_transforms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Conditional Transformations of Variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_untangled_groupby_agg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Grouping and summarizing data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_untangled_other_grouped_operations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Other Grouped Operations in Pandas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_untangled_joining_1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Introduction to Joining Datasets</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_untangled_joining_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Joining 2: One-to-Many, Multi-Key Joins &amp; Key Mismatches</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_untangled_pivoting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Reshaping Data with melt() and pivot()</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Using LLMs in Python</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_ai_LLM_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Using LLMs in Python for Text Generation</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#data-packages" id="toc-data-packages" class="nav-link active" data-scroll-target="#data-packages"><span class="header-section-number">21.1</span> Data &amp; Packages</a></li>
  <li><a href="#intro" id="toc-intro" class="nav-link" data-scroll-target="#intro"><span class="header-section-number">21.2</span> Intro</a></li>
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link" data-scroll-target="#learning-objectives"><span class="header-section-number">21.3</span> Learning Objectives</a></li>
  <li><a href="#why-do-we-need-joins" id="toc-why-do-we-need-joins" class="nav-link" data-scroll-target="#why-do-we-need-joins"><span class="header-section-number">21.4</span> Why Do We Need Joins?</a></li>
  <li><a href="#pd.merge-syntax" id="toc-pd.merge-syntax" class="nav-link" data-scroll-target="#pd.merge-syntax"><span class="header-section-number">21.5</span> pd.merge() syntax</a></li>
  <li><a href="#types-of-joins" id="toc-types-of-joins" class="nav-link" data-scroll-target="#types-of-joins"><span class="header-section-number">21.8</span> Types of joins</a></li>
  <li><a href="#left-join" id="toc-left-join" class="nav-link" data-scroll-target="#left-join"><span class="header-section-number">21.9</span> <code>left</code> join</a></li>
  <li><a href="#analysing-african-tb-incidence-and-health-expenditure" id="toc-analysing-african-tb-incidence-and-health-expenditure" class="nav-link" data-scroll-target="#analysing-african-tb-incidence-and-health-expenditure"><span class="header-section-number">21.11</span> Analysing African TB Incidence and Health Expenditure</a></li>
  <li><a href="#right-join" id="toc-right-join" class="nav-link" data-scroll-target="#right-join"><span class="header-section-number">21.13</span> <code>right</code> join</a></li>
  <li><a href="#inner-join" id="toc-inner-join" class="nav-link" data-scroll-target="#inner-join"><span class="header-section-number">21.14</span> <code>inner</code> join</a></li>
  <li><a href="#outer-join" id="toc-outer-join" class="nav-link" data-scroll-target="#outer-join"><span class="header-section-number">21.16</span> <code>outer</code> join</a></li>
  <li><a href="#wrap-up" id="toc-wrap-up" class="nav-link" data-scroll-target="#wrap-up"><span class="header-section-number">21.18</span> Wrap Up!</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/the-graph-courses/idap_book/edit/main/p_untangled_joining_1.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/the-graph-courses/idap_book/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./p_untangled_subset_columns.html">Data Manipulation</a></li><li class="breadcrumb-item"><a href="./p_untangled_joining_1.html"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Introduction to Joining Datasets</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Introduction to Joining Datasets</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="data-packages" class="level2" data-number="21.1">
<h2 data-number="21.1" class="anchored" data-anchor-id="data-packages"><span class="header-section-number">21.1</span> Data &amp; Packages</h2>
<p>Please run the code below to load the packages and datasets we’ll be using throughout this lesson.</p>
<div id="875178a2" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># TB incidence in Africa</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>tb_2019_africa <span class="op">=</span> pd.read_csv(</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"https://raw.githubusercontent.com/the-graph-courses/idap_book/main/data/tb_incidence_2019.csv"</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Health expenditure data</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>health_exp_2019 <span class="op">=</span> pd.read_csv(</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"https://raw.githubusercontent.com/the-graph-courses/idap_book/main/data/health_expend_per_cap_2019.csv"</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Highest expenditure countries</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>highest_exp <span class="op">=</span> health_exp_2019.sort_values(<span class="st">"expend_usd"</span>, ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">70</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># TB cases in children</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>tb_cases_children <span class="op">=</span> pd.read_csv(</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"https://raw.githubusercontent.com/the-graph-courses/idap_book/main/data/tb_cases_children_2012.csv"</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>).dropna()</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Country continents data</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>country_continents <span class="op">=</span> pd.read_csv(</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"https://raw.githubusercontent.com/the-graph-courses/idap_book/main/data/country_continents.csv"</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co"># people data</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>people <span class="op">=</span> pd.DataFrame({<span class="st">"name"</span>: [<span class="st">"Alice"</span>, <span class="st">"Bob"</span>, <span class="st">"Charlie"</span>], <span class="st">"age"</span>: [<span class="dv">25</span>, <span class="dv">32</span>, <span class="dv">45</span>]})</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Test information</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>test_info <span class="op">=</span> pd.DataFrame(</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>        <span class="st">"name"</span>: [<span class="st">"Alice"</span>, <span class="st">"Bob"</span>, <span class="st">"Charlie"</span>],</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>        <span class="st">"test_date"</span>: [<span class="st">"2023-06-05"</span>, <span class="st">"2023-08-10"</span>, <span class="st">"2023-07-15"</span>],</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>        <span class="st">"result"</span>: [<span class="st">"Negative"</span>, <span class="st">"Positive"</span>, <span class="st">"Negative"</span>],</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Disordered test information</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>test_info_disordered <span class="op">=</span> pd.DataFrame(</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>        <span class="st">"name"</span>: [<span class="st">"Bob"</span>, <span class="st">"Alice"</span>, <span class="st">"Charlie"</span>],  <span class="co"># Bob in first row</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>        <span class="st">"test_date"</span>: [<span class="st">"2023-08-10"</span>, <span class="st">"2023-06-05"</span>, <span class="st">"2023-07-15"</span>],</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>        <span class="st">"result"</span>: [<span class="st">"Positive"</span>, <span class="st">"Negative"</span>, <span class="st">"Negative"</span>],</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple test information</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>test_info_multiple <span class="op">=</span> pd.DataFrame(</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>        <span class="st">"name"</span>: [<span class="st">"Alice"</span>, <span class="st">"Alice"</span>, <span class="st">"Bob"</span>, <span class="st">"Charlie"</span>],</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>        <span class="st">"test_date"</span>: [<span class="st">"2023-06-05"</span>, <span class="st">"2023-06-06"</span>, <span class="st">"2023-08-10"</span>, <span class="st">"2023-07-15"</span>],</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>        <span class="st">"result"</span>: [<span class="st">"Negative"</span>, <span class="st">"Negative"</span>, <span class="st">"Positive"</span>, <span class="st">"Negative"</span>],</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Test information with different name</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>test_info_different_name <span class="op">=</span> pd.DataFrame(</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>        <span class="st">"first_name"</span>: [<span class="st">"Alice"</span>, <span class="st">"Bob"</span>, <span class="st">"Charlie"</span>],</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>        <span class="st">"test_date"</span>: [<span class="st">"2023-06-05"</span>, <span class="st">"2023-08-10"</span>, <span class="st">"2023-07-15"</span>],</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>        <span class="st">"result"</span>: [<span class="st">"Negative"</span>, <span class="st">"Positive"</span>, <span class="st">"Negative"</span>],</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Test information including Xavier</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>test_info_xavier <span class="op">=</span> pd.DataFrame(</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>        <span class="st">"name"</span>: [<span class="st">"Alice"</span>, <span class="st">"Bob"</span>, <span class="st">"Xavier"</span>],</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>        <span class="st">"test_date"</span>: [<span class="st">"2023-06-05"</span>, <span class="st">"2023-08-10"</span>, <span class="st">"2023-05-02"</span>],</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>        <span class="st">"result"</span>: [<span class="st">"Negative"</span>, <span class="st">"Positive"</span>, <span class="st">"Negative"</span>],</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Students data</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>students <span class="op">=</span> pd.DataFrame(</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>    {<span class="st">"student_id"</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], <span class="st">"name"</span>: [<span class="st">"Alice"</span>, <span class="st">"Bob"</span>, <span class="st">"Charlie"</span>], <span class="st">"age"</span>: [<span class="dv">20</span>, <span class="dv">22</span>, <span class="dv">21</span>]}</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a><span class="co"># Exam dates data</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>exam_dates <span class="op">=</span> pd.DataFrame(</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>    {<span class="st">"student_id"</span>: [<span class="dv">1</span>, <span class="dv">3</span>], <span class="st">"exam_date"</span>: [<span class="st">"2023-05-20"</span>, <span class="st">"2023-05-22"</span>]}</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a><span class="co"># Employee details</span></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>employee_details <span class="op">=</span> pd.DataFrame(</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>        <span class="st">"id_number"</span>: [<span class="st">"E001"</span>, <span class="st">"E002"</span>, <span class="st">"E003"</span>],</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>        <span class="st">"full_name"</span>: [<span class="st">"Emily"</span>, <span class="st">"Frank"</span>, <span class="st">"Grace"</span>],</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>        <span class="st">"department"</span>: [<span class="st">"HR"</span>, <span class="st">"IT"</span>, <span class="st">"Marketing"</span>],</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a><span class="co"># Performance reviews</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>performance_reviews <span class="op">=</span> pd.DataFrame(</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>        <span class="st">"employee_code"</span>: [<span class="st">"E001"</span>, <span class="st">"E002"</span>, <span class="st">"E003"</span>],</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>        <span class="st">"review_type"</span>: [<span class="st">"Annual"</span>, <span class="st">"Mid-year"</span>, <span class="st">"Annual"</span>],</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>        <span class="st">"review_date"</span>: [<span class="st">"2022-05-10"</span>, <span class="st">"2023-09-01"</span>, <span class="st">"2021-12-15"</span>],</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a><span class="co"># Sales data</span></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>sales_data <span class="op">=</span> pd.DataFrame(</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>        <span class="st">"salesperson_id"</span>: [<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">8</span>],</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>        <span class="st">"product"</span>: [<span class="st">"Laptop"</span>, <span class="st">"Smartphone"</span>, <span class="st">"Tablet"</span>],</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>        <span class="st">"date_of_sale"</span>: [<span class="st">"2023-01-15"</span>, <span class="st">"2023-03-05"</span>, <span class="st">"2023-02-20"</span>],</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a><span class="co"># Salesperson peoples</span></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>salesperson_peoples <span class="op">=</span> pd.DataFrame(</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>        <span class="st">"salesperson_id"</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">8</span>],</span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>        <span class="st">"name"</span>: [<span class="st">"Alice"</span>, <span class="st">"Bob"</span>, <span class="st">"Charlie"</span>, <span class="st">"Diana"</span>, <span class="st">"Eve"</span>],</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>        <span class="st">"age"</span>: [<span class="dv">28</span>, <span class="dv">45</span>, <span class="dv">32</span>, <span class="dv">55</span>, <span class="dv">40</span>],</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>        <span class="st">"gender"</span>: [<span class="st">"Female"</span>, <span class="st">"Male"</span>, <span class="st">"Male"</span>, <span class="st">"Female"</span>, <span class="st">"Female"</span>],</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a><span class="co"># Total sales data</span></span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>total_sales <span class="op">=</span> pd.DataFrame(</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>        <span class="st">"product"</span>: [</span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Laptop"</span>,</span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Desktop"</span>,</span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Tablet"</span>,</span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Smartphone"</span>,</span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Smartwatch"</span>,</span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Headphones"</span>,</span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Monitor"</span>,</span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Keyboard"</span>,</span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Mouse"</span>,</span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Printer"</span>,</span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>        ],</span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>        <span class="st">"total_units_sold"</span>: [<span class="dv">9751</span>, <span class="dv">136</span>, <span class="dv">8285</span>, <span class="dv">2478</span>, <span class="dv">3642</span>, <span class="dv">5231</span>, <span class="dv">1892</span>, <span class="dv">4267</span>, <span class="dv">3891</span>, <span class="dv">982</span>],</span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a><span class="co"># Product feedback data</span></span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>product_feedback <span class="op">=</span> pd.DataFrame(</span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>        <span class="st">"product"</span>: [</span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Laptop"</span>,</span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Desktop"</span>,</span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Tablet"</span>,</span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Smartphone"</span>,</span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Smartwatch"</span>,</span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Headphones"</span>,</span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Monitor"</span>,</span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Gaming Console"</span>,</span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Camera"</span>,</span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Speaker"</span>,</span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>        ],</span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>        <span class="st">"n_positive_reviews"</span>: [<span class="dv">1938</span>, <span class="dv">128</span>, <span class="dv">842</span>, <span class="dv">1567</span>, <span class="dv">723</span>, <span class="dv">956</span>, <span class="dv">445</span>, <span class="dv">582</span>, <span class="dv">234</span>, <span class="dv">678</span>],</span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>        <span class="st">"n_negative_reviews"</span>: [<span class="dv">42</span>, <span class="dv">30</span>, <span class="dv">56</span>, <span class="dv">89</span>, <span class="dv">34</span>, <span class="dv">28</span>, <span class="dv">15</span>, <span class="dv">11</span>, <span class="dv">8</span>, <span class="dv">25</span>],</span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a><span class="co"># Sales incidence data</span></span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>sales <span class="op">=</span> pd.DataFrame(</span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a>        <span class="st">"year"</span>: [<span class="dv">2010</span>, <span class="dv">2011</span>, <span class="dv">2014</span>, <span class="dv">2016</span>, <span class="dv">2017</span>],</span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>        <span class="st">"sales_count"</span>: [<span class="dv">69890</span>, <span class="dv">66507</span>, <span class="dv">59831</span>, <span class="dv">58704</span>, <span class="dv">59151</span>],</span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a><span class="co"># Customer complaints data</span></span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a>customer_complaints <span class="op">=</span> pd.DataFrame(</span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a>        <span class="st">"year"</span>: [<span class="dv">2011</span>, <span class="dv">2013</span>, <span class="dv">2015</span>, <span class="dv">2016</span>, <span class="dv">2019</span>],</span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a>        <span class="st">"complaints_count"</span>: [<span class="dv">1292</span>, <span class="dv">1100</span>, <span class="dv">1011</span>, <span class="dv">940</span>, <span class="dv">895</span>],</span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a>employees <span class="op">=</span> pd.DataFrame(</span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a>    {<span class="st">"employee_id"</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], <span class="st">"name"</span>: [<span class="st">"John"</span>, <span class="st">"Joy"</span>, <span class="st">"Khan"</span>], <span class="st">"age"</span>: [<span class="dv">32</span>, <span class="dv">28</span>, <span class="dv">40</span>]}</span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a>training_sessions <span class="op">=</span> pd.DataFrame(</span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a>        <span class="st">"employee_id"</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a>        <span class="st">"training_date"</span>: [<span class="st">"2023-01-20"</span>, <span class="st">"2023-02-20"</span>, <span class="st">"2023-05-15"</span>],</span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a>customer_details <span class="op">=</span> pd.DataFrame(</span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a>        <span class="st">"id_number"</span>: [<span class="st">"A001"</span>, <span class="st">"B002"</span>, <span class="st">"C003"</span>],</span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a>        <span class="st">"full_name"</span>: [<span class="st">"Alice"</span>, <span class="st">"Bob"</span>, <span class="st">"Charlie"</span>],</span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a>        <span class="st">"address"</span>: [<span class="st">"123 Elm St"</span>, <span class="st">"456 Maple Dr"</span>, <span class="st">"789 Oak Blvd"</span>],</span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a><span class="co"># Order Records</span></span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a>order_records <span class="op">=</span> pd.DataFrame(</span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a>        <span class="st">"customer_code"</span>: [<span class="st">"A001"</span>, <span class="st">"B002"</span>, <span class="st">"C003"</span>],</span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a>        <span class="st">"product_type"</span>: [<span class="st">"Electronics"</span>, <span class="st">"Books"</span>, <span class="st">"Clothing"</span>],</span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a>        <span class="st">"order_date"</span>: [<span class="st">"2022-05-10"</span>, <span class="st">"2023-09-01"</span>, <span class="st">"2021-12-15"</span>],</span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="intro" class="level2" data-number="21.2">
<h2 data-number="21.2" class="anchored" data-anchor-id="intro"><span class="header-section-number">21.2</span> Intro</h2>
<p>Joining is a key skill when working with data as it allows you to combine information about the same entities from multiple sources, leading to more comprehensive and insightful analyses. In this lesson, you’ll learn how to use different joining techniques using Python’s <code>pandas</code> library. Let’s get started!</p>
</section>
<section id="learning-objectives" class="level2" data-number="21.3">
<h2 data-number="21.3" class="anchored" data-anchor-id="learning-objectives"><span class="header-section-number">21.3</span> Learning Objectives</h2>
<ul>
<li><p>You understand how each of the different joins work: left, right, inner, and outer.</p></li>
<li><p>You can join simple datasets together using the <code>pd.merge()</code> function.</p></li>
</ul>
</section>
<section id="why-do-we-need-joins" class="level2" data-number="21.4">
<h2 data-number="21.4" class="anchored" data-anchor-id="why-do-we-need-joins"><span class="header-section-number">21.4</span> Why Do We Need Joins?</h2>
<p>To illustrate the utility of joins, let’s start with a toy example. Consider the following two datasets. The first, <code>people</code>, contains names and ages of three individuals:</p>
<div id="db9c574b" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>people</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Alice</td>
<td>25</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Bob</td>
<td>32</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Charlie</td>
<td>45</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The second, <code>test_info</code>, contains test dates and results for those individuals:</p>
<div id="2e841b96" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>test_info</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">test_date</th>
<th data-quarto-table-cell-role="th">result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Alice</td>
<td>2023-06-05</td>
<td>Negative</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Bob</td>
<td>2023-08-10</td>
<td>Positive</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Charlie</td>
<td>2023-07-15</td>
<td>Negative</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>We’d like to analyze these data together, and so we need a way to combine them.</p>
<p>One option we might consider is concatenating the dataframes horizontally using <code>pd.concat()</code>:</p>
<div id="54415e5c" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>pd.concat([people, test_info], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">test_date</th>
<th data-quarto-table-cell-role="th">result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Alice</td>
<td>25</td>
<td>Alice</td>
<td>2023-06-05</td>
<td>Negative</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Bob</td>
<td>32</td>
<td>Bob</td>
<td>2023-08-10</td>
<td>Positive</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Charlie</td>
<td>45</td>
<td>Charlie</td>
<td>2023-07-15</td>
<td>Negative</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>This successfully merges the datasets, but it doesn’t do so very intelligently. The function essentially “pastes” or “staples” the two tables together. So, as you can notice, the “name” column appears twice. This is not ideal and will be problematic for analysis.</p>
<p>Another problem occurs if the rows in the two datasets are not already aligned. In this case, the data will be combined incorrectly with <code>pd.concat()</code>. Consider the <code>test_info_disordered</code> dataset, which now has Bob in the first row:</p>
<div id="bf01bd2d" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>test_info_disordered</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">test_date</th>
<th data-quarto-table-cell-role="th">result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Bob</td>
<td>2023-08-10</td>
<td>Positive</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Alice</td>
<td>2023-06-05</td>
<td>Negative</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Charlie</td>
<td>2023-07-15</td>
<td>Negative</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>What happens if we concatenate this with the original <code>people</code> dataset, where Bob was in the <em>second</em> row?</p>
<div id="0bb6f33b" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>pd.concat([people, test_info_disordered], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">test_date</th>
<th data-quarto-table-cell-role="th">result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Alice</td>
<td>25</td>
<td>Bob</td>
<td>2023-08-10</td>
<td>Positive</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Bob</td>
<td>32</td>
<td>Alice</td>
<td>2023-06-05</td>
<td>Negative</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Charlie</td>
<td>45</td>
<td>Charlie</td>
<td>2023-07-15</td>
<td>Negative</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Alice’s people details are now mistakenly aligned with Bob’s test info!</p>
<p>A third issue arises when an entity appears more than once in one dataset. Perhaps Alice had multiple tests:</p>
<div id="7b401eb1" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>test_info_multiple</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">test_date</th>
<th data-quarto-table-cell-role="th">result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Alice</td>
<td>2023-06-05</td>
<td>Negative</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Alice</td>
<td>2023-06-06</td>
<td>Negative</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Bob</td>
<td>2023-08-10</td>
<td>Positive</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Charlie</td>
<td>2023-07-15</td>
<td>Negative</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>If we try to concatenate this with the <code>people</code> dataset, we’ll get mismatched data due to differing row counts:</p>
<div id="8b9a2d57" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>pd.concat([people, test_info_multiple], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">test_date</th>
<th data-quarto-table-cell-role="th">result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Alice</td>
<td>25.0</td>
<td>Alice</td>
<td>2023-06-05</td>
<td>Negative</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Bob</td>
<td>32.0</td>
<td>Alice</td>
<td>2023-06-06</td>
<td>Negative</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Charlie</td>
<td>45.0</td>
<td>Bob</td>
<td>2023-08-10</td>
<td>Positive</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>NaN</td>
<td>Charlie</td>
<td>2023-07-15</td>
<td>Negative</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>This results in NaN values and misaligned data.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Side Note">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Side Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>What we have here is called a <strong>one-to-many</strong> relationship—one Alice in the people data, but multiple Alice rows in the test data since she had multiple tests. Joining in such cases will be covered in detail in the second joining lesson.</p>
</div>
</div>
<hr>
<p>Clearly, we need a smarter way to combine datasets than concatenation; we’ll need to venture into the world of joining. In pandas, the function that performs joins is <code>pd.merge()</code>.</p>
<p>It works for the simple case, and it does not duplicate the name column:</p>
<div id="dd3fbe06" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>pd.merge(people, test_info)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">test_date</th>
<th data-quarto-table-cell-role="th">result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Alice</td>
<td>25</td>
<td>2023-06-05</td>
<td>Negative</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Bob</td>
<td>32</td>
<td>2023-08-10</td>
<td>Positive</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Charlie</td>
<td>45</td>
<td>2023-07-15</td>
<td>Negative</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>It works where the datasets are not ordered identically:</p>
<div id="a98679b4" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>pd.merge(people, test_info_disordered)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">test_date</th>
<th data-quarto-table-cell-role="th">result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Alice</td>
<td>25</td>
<td>2023-06-05</td>
<td>Negative</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Bob</td>
<td>32</td>
<td>2023-08-10</td>
<td>Positive</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Charlie</td>
<td>45</td>
<td>2023-07-15</td>
<td>Negative</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>As you can see, Alice’s details are now correctly aligned with her test results.</p>
<p>And it works when there are multiple test rows per individual:</p>
<div id="87ff978d" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>pd.merge(people, test_info_multiple)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">test_date</th>
<th data-quarto-table-cell-role="th">result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Alice</td>
<td>25</td>
<td>2023-06-05</td>
<td>Negative</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Alice</td>
<td>25</td>
<td>2023-06-06</td>
<td>Negative</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Bob</td>
<td>32</td>
<td>2023-08-10</td>
<td>Positive</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Charlie</td>
<td>45</td>
<td>2023-07-15</td>
<td>Negative</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>In this case, the <code>pd.merge()</code> function correctly repeats Alice’s details for each of her tests.</p>
<p>Simple and beautiful!</p>
</section>
<section id="pd.merge-syntax" class="level2" data-number="21.5">
<h2 data-number="21.5" class="anchored" data-anchor-id="pd.merge-syntax"><span class="header-section-number">21.5</span> pd.merge() syntax</h2>
<p>Now that we understand <em>why</em> we need joins, let’s look at their basic syntax.</p>
<p>Joins take two dataframes as the first two arguments: <code>left</code> (the <em>left</em> dataframe) and <code>right</code> (the <em>right</em> dataframe). In pandas, you can provide these as positional or keyword arguments:</p>
<div id="5a9b6452" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># left and right</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>pd.merge(left<span class="op">=</span>people, right<span class="op">=</span>test_info)  <span class="co"># keyword arguments</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>pd.merge(people, test_info)  <span class="co"># positional arguments</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">test_date</th>
<th data-quarto-table-cell-role="th">result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Alice</td>
<td>25</td>
<td>2023-06-05</td>
<td>Negative</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Bob</td>
<td>32</td>
<td>2023-08-10</td>
<td>Positive</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Charlie</td>
<td>45</td>
<td>2023-07-15</td>
<td>Negative</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Another critical argument is <code>on</code>, which indicates the column or <strong>key</strong> used to connect the tables. We don’t always need to supply this argument; it can be <em>inferred</em> from the datasets. For example, in our original examples, “name” is the only column common to <code>people</code> and <code>test_info</code>. So the merge function assumes <code>on='name'</code>:</p>
<div id="b203df99" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># on argument is optional if the column key is the same in both dataframes</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>pd.merge(people, test_info)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>pd.merge(people, test_info, on<span class="op">=</span><span class="st">"name"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">test_date</th>
<th data-quarto-table-cell-role="th">result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Alice</td>
<td>25</td>
<td>2023-06-05</td>
<td>Negative</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Bob</td>
<td>32</td>
<td>2023-08-10</td>
<td>Positive</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Charlie</td>
<td>45</td>
<td>2023-07-15</td>
<td>Negative</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Vocab">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Vocab
</div>
</div>
<div class="callout-body-container callout-body">
<p>The column used to connect rows across the tables is known as a <strong>key</strong>. In the pandas <code>merge()</code> function, the key is specified in the <code>on</code> argument, as seen in <code>pd.merge(people, test_info, on='name')</code>.</p>
</div>
</div>
<p>What happens if the keys are named differently in the two datasets? Consider the <code>test_info_different_name</code> dataset, where the “name” column has been changed to “first_name”:</p>
<div id="f5ba67d5" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>test_info_different_name</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">first_name</th>
<th data-quarto-table-cell-role="th">test_date</th>
<th data-quarto-table-cell-role="th">result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Alice</td>
<td>2023-06-05</td>
<td>Negative</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Bob</td>
<td>2023-08-10</td>
<td>Positive</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Charlie</td>
<td>2023-07-15</td>
<td>Negative</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>If we try to join <code>test_info_different_name</code> with our original <code>people</code> dataset, we will encounter an error:</p>
<div id="f95675b6" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>pd.merge(people, test_info_different_name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>MergeError: No common columns to perform merge on. Merge options: left_on=None, right_on=None, left_index=False, right_index=False</code></pre>
<p>The error indicates that there are no common variables, so the join is not possible.</p>
<p>In situations like this, you have two choices: you can rename the column in the second dataframe to match the first, or more simply, specify which columns to join on using <code>left_on</code> and <code>right_on</code>.</p>
<p>Here’s how to do this:</p>
<div id="4100583c" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>pd.merge(people, test_info_different_name, left_on<span class="op">=</span><span class="st">'name'</span>, right_on<span class="op">=</span><span class="st">'first_name'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">first_name</th>
<th data-quarto-table-cell-role="th">test_date</th>
<th data-quarto-table-cell-role="th">result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Alice</td>
<td>25</td>
<td>Alice</td>
<td>2023-06-05</td>
<td>Negative</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Bob</td>
<td>32</td>
<td>Bob</td>
<td>2023-08-10</td>
<td>Positive</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Charlie</td>
<td>45</td>
<td>Charlie</td>
<td>2023-07-15</td>
<td>Negative</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>This syntax essentially says, “Connect <code>name</code> from the left dataframe with <code>first_name</code> from the right dataframe because they represent the same data.”</p>
<hr>
<div class="callout callout-style-default callout-note callout-titled" title="Vocab">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Vocab
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Key</strong>: The column or set of columns used to match rows between two dataframes in a join operation.</p>
<p><strong>Left Join</strong>: A type of join that keeps all rows from the left dataframe and adds matching rows from the right dataframe. If there is no match, the result is <code>NaN</code> on the right side.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Practice">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practice
</div>
</div>
<section id="practice-q-join-employees-and-training-sessions" class="level2 callout-body-container callout-body" data-number="21.6">
<h2 data-number="21.6" class="anchored" data-anchor-id="practice-q-join-employees-and-training-sessions"><span class="header-section-number">21.6</span> Practice Q: Join Employees and Training Sessions</h2>
<p>Consider the two datasets below, one with employee details and the other with training session dates for these employees.</p>
<div id="8fbce55b" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>employees</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">employee_id</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>John</td>
<td>32</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>Joy</td>
<td>28</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>Khan</td>
<td>40</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="6e68aeaf" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>training_sessions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">employee_id</th>
<th data-quarto-table-cell-role="th">training_date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>2023-01-20</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>2023-02-20</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>2023-05-15</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>How many rows and columns would you expect to have after joining these two datasets?</p>
<p>Now join the two datasets and check your answer.</p>
<div id="6790c062" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Your code here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Practice">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practice
</div>
</div>
<section id="practice-q-join-with-on-argument" class="level2 callout-body-container callout-body" data-number="21.7">
<h2 data-number="21.7" class="anchored" data-anchor-id="practice-q-join-with-on-argument"><span class="header-section-number">21.7</span> Practice Q: Join with <code>on</code> Argument</h2>
<p>Two datasets are shown below, one with customer details and the other with order records for those customers.</p>
<div id="2a33489f" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>customer_details</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id_number</th>
<th data-quarto-table-cell-role="th">full_name</th>
<th data-quarto-table-cell-role="th">address</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>A001</td>
<td>Alice</td>
<td>123 Elm St</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>B002</td>
<td>Bob</td>
<td>456 Maple Dr</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>C003</td>
<td>Charlie</td>
<td>789 Oak Blvd</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="0c3d5841" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>order_records</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">customer_code</th>
<th data-quarto-table-cell-role="th">product_type</th>
<th data-quarto-table-cell-role="th">order_date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>A001</td>
<td>Electronics</td>
<td>2022-05-10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>B002</td>
<td>Books</td>
<td>2023-09-01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>C003</td>
<td>Clothing</td>
<td>2021-12-15</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Join the <code>customer_details</code> and <code>order_records</code> datasets. You will need to use the <code>left_on</code> and <code>right_on</code> arguments because the customer identifier columns have different names.</p>
</section>
</div>
</section>
<section id="types-of-joins" class="level2" data-number="21.8">
<h2 data-number="21.8" class="anchored" data-anchor-id="types-of-joins"><span class="header-section-number">21.8</span> Types of joins</h2>
<p>The toy examples so far have involved datasets that could be matched perfectly—every row in one dataset had a corresponding row in the other dataset.</p>
<p>Real-world data is usually messier. Often, there will be entries in the first table that do not have corresponding entries in the second table, and vice versa.</p>
<p>To handle these cases of imperfect matching, there are different join types with specific behaviors: <code>left</code>, <code>right</code>, <code>inner</code>, and <code>outer</code>. In the upcoming sections, we’ll look at examples of how each join type operates on datasets with imperfect matches.</p>
</section>
<section id="left-join" class="level2" data-number="21.9">
<h2 data-number="21.9" class="anchored" data-anchor-id="left-join"><span class="header-section-number">21.9</span> <code>left</code> join</h2>
<p>Let’s start with the <code>left</code> join. To see how it handles unmatched rows, we will try to join our original <code>people</code> dataset with a modified version of the <code>test_info</code> dataset.</p>
<p>As a reminder, here is the <code>people</code> dataset, with Alice, Bob, and Charlie:</p>
<div id="8bb4818e" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>people</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Alice</td>
<td>25</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Bob</td>
<td>32</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Charlie</td>
<td>45</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>For test information, we’ll remove <code>Charlie</code> and we’ll add a new individual, <code>Xavier</code>, and his test data:</p>
<div id="961fe719" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>test_info_xavier</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">test_date</th>
<th data-quarto-table-cell-role="th">result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Alice</td>
<td>2023-06-05</td>
<td>Negative</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Bob</td>
<td>2023-08-10</td>
<td>Positive</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Xavier</td>
<td>2023-05-02</td>
<td>Negative</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>We can specify the join type using the <code>how</code> argument:</p>
<div id="7b3c4367" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>pd.merge(people, test_info_xavier, how<span class="op">=</span><span class="st">'left'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">test_date</th>
<th data-quarto-table-cell-role="th">result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Alice</td>
<td>25</td>
<td>2023-06-05</td>
<td>Negative</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Bob</td>
<td>32</td>
<td>2023-08-10</td>
<td>Positive</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Charlie</td>
<td>45</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>As you can see, with the <em>left</em> join, all records from the <em>left</em> dataframe (<code>people</code>) are retained. So, even though <code>Charlie</code> doesn’t have a match in the <code>test_info_xavier</code> dataset, he’s still included in the output. (But of course, since his test information is not available in <code>test_info_xavier</code>, those values were left as <code>NaN</code>.)</p>
<p>Xavier, on the other hand, who was only present in the right dataset, gets dropped.</p>
<p>The graphic below shows how this join worked:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/left_join1.gif" class="img-fluid figure-img"></p>
<figcaption>Left Join</figcaption>
</figure>
</div>
<p>Now what if we flip the dataframes? Let’s see the outcome when <code>test_info_xavier</code> is the left dataframe and <code>people</code> is the right one:</p>
<div id="6309f40e" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>pd.merge(test_info_xavier, people, on<span class="op">=</span><span class="st">'name'</span>, how<span class="op">=</span><span class="st">'left'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">test_date</th>
<th data-quarto-table-cell-role="th">result</th>
<th data-quarto-table-cell-role="th">age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Alice</td>
<td>2023-06-05</td>
<td>Negative</td>
<td>25.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Bob</td>
<td>2023-08-10</td>
<td>Positive</td>
<td>32.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Xavier</td>
<td>2023-05-02</td>
<td>Negative</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Once again, the <code>left</code> join retains all rows from the <em>left</em> dataframe (now <code>test_info_xavier</code>). This means Xavier’s data is included this time. Charlie, on the other hand, is excluded.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Key Point">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Point
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Primary Dataset</strong>: In the context of joins, the primary dataset refers to the main or prioritized dataset in an operation. In a left join, the left dataframe is considered the primary dataset because all of its rows are retained in the output, regardless of whether they have a matching row in the other dataframe.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Practice">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practice
</div>
</div>
<section id="practice-q-left-join-students-and-exam-dates" class="level2 callout-body-container callout-body" data-number="21.10">
<h2 data-number="21.10" class="anchored" data-anchor-id="practice-q-left-join-students-and-exam-dates"><span class="header-section-number">21.10</span> Practice Q: Left Join Students and Exam Dates</h2>
<p>Consider the two datasets below, one with student details and the other with exam dates for some of these students.</p>
<div id="e8f8a36d" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>students</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">student_id</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>Alice</td>
<td>20</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>Bob</td>
<td>22</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>Charlie</td>
<td>21</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="98d36b11" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>exam_dates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">student_id</th>
<th data-quarto-table-cell-role="th">exam_date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>2023-05-20</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>3</td>
<td>2023-05-22</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Join the <code>students</code> dataset with the <code>exam_dates</code> dataset using a left join.</p>
</section>
</div>
<hr>
</section>
<section id="analysing-african-tb-incidence-and-health-expenditure" class="level2" data-number="21.11">
<h2 data-number="21.11" class="anchored" data-anchor-id="analysing-african-tb-incidence-and-health-expenditure"><span class="header-section-number">21.11</span> Analysing African TB Incidence and Health Expenditure</h2>
<p>Let’s try another example, this time with a more realistic set of data.</p>
<p>First, we have data on the TB incidence rate per 100,000 people for some African countries, from the <a href="https://www.who.int/data/gho/data/indicators/indicator-details/GHO/incidence-of-tuberculosis-(per-100-000-population-per-year)">WHO</a>:</p>
<div id="8373fc7a" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>tb_2019_africa</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">cases</th>
<th data-quarto-table-cell-role="th">conf_int_95</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Burundi</td>
<td>107</td>
<td>[69 – 153]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Sao Tome and Principe</td>
<td>114</td>
<td>[45 – 214]</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Senegal</td>
<td>117</td>
<td>[83 – 156]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Mauritius</td>
<td>12</td>
<td>[9 – 15]</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Côte d’Ivoire</td>
<td>137</td>
<td>[88 – 197]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Ethiopia</td>
<td>140</td>
<td>[98 – 188]</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Chad</td>
<td>142</td>
<td>[92 – 202]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Ghana</td>
<td>144</td>
<td>[70 – 244]</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Malawi</td>
<td>146</td>
<td>[78 – 235]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Seychelles</td>
<td>15</td>
<td>[13 – 18]</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>Gambia</td>
<td>158</td>
<td>[117 – 204]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>Guinea</td>
<td>176</td>
<td>[114 – 251]</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>Cameroon</td>
<td>179</td>
<td>[116 – 255]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>Zimbabwe</td>
<td>199</td>
<td>[147 – 258]</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>Uganda</td>
<td>200</td>
<td>[117 – 303]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>Nigeria</td>
<td>219</td>
<td>[143 – 311]</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>South Sudan</td>
<td>227</td>
<td>[147 – 324]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>Madagascar</td>
<td>233</td>
<td>[151 – 333]</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>United Republic of Tanzania</td>
<td>237</td>
<td>[112 – 408]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>Botswana</td>
<td>253</td>
<td>[195 – 317]</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>Kenya</td>
<td>267</td>
<td>[163 – 396]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>Equatorial Guinea</td>
<td>286</td>
<td>[185 – 408]</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>Sierra Leone</td>
<td>295</td>
<td>[190 – 422]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>Liberia</td>
<td>308</td>
<td>[199 – 440]</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>Democratic Republic of the Congo</td>
<td>320</td>
<td>[207 – 457]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25</td>
<td>Zambia</td>
<td>333</td>
<td>[216 – 474]</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26</td>
<td>Comoros</td>
<td>35</td>
<td>[23 – 50]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27</td>
<td>Angola</td>
<td>351</td>
<td>[227 – 501]</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28</td>
<td>Mozambique</td>
<td>361</td>
<td>[223 – 532]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">29</td>
<td>Guinea-Bissau</td>
<td>361</td>
<td>[234 – 516]</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">30</td>
<td>Eswatini</td>
<td>363</td>
<td>[228 – 527]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">31</td>
<td>Togo</td>
<td>37</td>
<td>[30 – 45]</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">32</td>
<td>Congo</td>
<td>373</td>
<td>[237 – 541]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">33</td>
<td>Cabo Verde</td>
<td>46</td>
<td>[35 – 58]</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">34</td>
<td>Burkina Faso</td>
<td>47</td>
<td>[30 – 67]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35</td>
<td>Namibia</td>
<td>486</td>
<td>[348 – 647]</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">36</td>
<td>Mali</td>
<td>52</td>
<td>[34 – 74]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">37</td>
<td>Gabon</td>
<td>521</td>
<td>[337 – 744]</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">38</td>
<td>Central African Republic</td>
<td>540</td>
<td>[349 – 771]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">39</td>
<td>Benin</td>
<td>55</td>
<td>[36 – 79]</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">40</td>
<td>Rwanda</td>
<td>57</td>
<td>[44 – 72]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">41</td>
<td>Algeria</td>
<td>61</td>
<td>[46 – 77]</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">42</td>
<td>South Africa</td>
<td>615</td>
<td>[427 – 835]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">43</td>
<td>Lesotho</td>
<td>654</td>
<td>[406 – 959]</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">44</td>
<td>Niger</td>
<td>84</td>
<td>[54 – 120]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">45</td>
<td>Eritrea</td>
<td>86</td>
<td>[40 – 151]</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">46</td>
<td>Mauritania</td>
<td>89</td>
<td>[58 – 127]</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>We want to analyze how TB incidence in African countries varies with government health expenditure per capita. For this, we have data on health expenditure per capita in USD, also from the WHO, for countries from all continents:</p>
<div id="d74cb667" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>health_exp_2019</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">expend_usd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Nigeria</td>
<td>10.97</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Bahamas</td>
<td>1002.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>United Arab Emirates</td>
<td>1015.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Nauru</td>
<td>1038.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Slovakia</td>
<td>1058.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">180</td>
<td>Myanmar</td>
<td>9.64</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">181</td>
<td>Malawi</td>
<td>9.78</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">182</td>
<td>Cuba</td>
<td>901.80</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">183</td>
<td>Tunisia</td>
<td>97.75</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">184</td>
<td>Nicaragua</td>
<td>99.73</td>
</tr>
</tbody>
</table>

<p>185 rows × 2 columns</p>
</div>
</div>
</div>
<p>Which dataset should we use as the left dataframe for the join?</p>
<p>Since our goal is to analyze African countries, we should use <code>tb_2019_africa</code> as the left dataframe. This will ensure we keep all the African countries in the final joined dataset.</p>
<p>Let’s join them:</p>
<div id="86374863" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>tb_health_exp_joined <span class="op">=</span> pd.merge(tb_2019_africa, health_exp_2019, on<span class="op">=</span><span class="st">'country'</span>, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>tb_health_exp_joined</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">cases</th>
<th data-quarto-table-cell-role="th">conf_int_95</th>
<th data-quarto-table-cell-role="th">expend_usd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Burundi</td>
<td>107</td>
<td>[69 – 153]</td>
<td>6.07</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Sao Tome and Principe</td>
<td>114</td>
<td>[45 – 214]</td>
<td>47.64</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Senegal</td>
<td>117</td>
<td>[83 – 156]</td>
<td>15.47</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Mauritius</td>
<td>12</td>
<td>[9 – 15]</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Côte d’Ivoire</td>
<td>137</td>
<td>[88 – 197]</td>
<td>22.25</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Ethiopia</td>
<td>140</td>
<td>[98 – 188]</td>
<td>5.93</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Chad</td>
<td>142</td>
<td>[92 – 202]</td>
<td>4.76</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Ghana</td>
<td>144</td>
<td>[70 – 244]</td>
<td>30.01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Malawi</td>
<td>146</td>
<td>[78 – 235]</td>
<td>9.78</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Seychelles</td>
<td>15</td>
<td>[13 – 18]</td>
<td>572.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>Gambia</td>
<td>158</td>
<td>[117 – 204]</td>
<td>9.40</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>Guinea</td>
<td>176</td>
<td>[114 – 251]</td>
<td>9.61</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>Cameroon</td>
<td>179</td>
<td>[116 – 255]</td>
<td>6.26</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>Zimbabwe</td>
<td>199</td>
<td>[147 – 258]</td>
<td>7.82</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>Uganda</td>
<td>200</td>
<td>[117 – 303]</td>
<td>5.05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>Nigeria</td>
<td>219</td>
<td>[143 – 311]</td>
<td>10.97</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>South Sudan</td>
<td>227</td>
<td>[147 – 324]</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>Madagascar</td>
<td>233</td>
<td>[151 – 333]</td>
<td>6.26</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>United Republic of Tanzania</td>
<td>237</td>
<td>[112 – 408]</td>
<td>16.02</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>Botswana</td>
<td>253</td>
<td>[195 – 317]</td>
<td>292.10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>Kenya</td>
<td>267</td>
<td>[163 – 396]</td>
<td>39.57</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>Equatorial Guinea</td>
<td>286</td>
<td>[185 – 408]</td>
<td>47.30</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>Sierra Leone</td>
<td>295</td>
<td>[190 – 422]</td>
<td>6.28</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>Liberia</td>
<td>308</td>
<td>[199 – 440]</td>
<td>8.38</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>Democratic Republic of the Congo</td>
<td>320</td>
<td>[207 – 457]</td>
<td>3.14</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25</td>
<td>Zambia</td>
<td>333</td>
<td>[216 – 474]</td>
<td>27.09</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26</td>
<td>Comoros</td>
<td>35</td>
<td>[23 – 50]</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27</td>
<td>Angola</td>
<td>351</td>
<td>[227 – 501]</td>
<td>28.59</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28</td>
<td>Mozambique</td>
<td>361</td>
<td>[223 – 532]</td>
<td>9.35</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">29</td>
<td>Guinea-Bissau</td>
<td>361</td>
<td>[234 – 516]</td>
<td>3.90</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">30</td>
<td>Eswatini</td>
<td>363</td>
<td>[228 – 527]</td>
<td>131.50</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">31</td>
<td>Togo</td>
<td>37</td>
<td>[30 – 45]</td>
<td>7.56</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">32</td>
<td>Congo</td>
<td>373</td>
<td>[237 – 541]</td>
<td>25.82</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">33</td>
<td>Cabo Verde</td>
<td>46</td>
<td>[35 – 58]</td>
<td>111.50</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">34</td>
<td>Burkina Faso</td>
<td>47</td>
<td>[30 – 67]</td>
<td>17.17</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35</td>
<td>Namibia</td>
<td>486</td>
<td>[348 – 647]</td>
<td>204.30</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">36</td>
<td>Mali</td>
<td>52</td>
<td>[34 – 74]</td>
<td>11.03</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">37</td>
<td>Gabon</td>
<td>521</td>
<td>[337 – 744]</td>
<td>125.60</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">38</td>
<td>Central African Republic</td>
<td>540</td>
<td>[349 – 771]</td>
<td>3.58</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">39</td>
<td>Benin</td>
<td>55</td>
<td>[36 – 79]</td>
<td>6.33</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">40</td>
<td>Rwanda</td>
<td>57</td>
<td>[44 – 72]</td>
<td>20.20</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">41</td>
<td>Algeria</td>
<td>61</td>
<td>[46 – 77]</td>
<td>163.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">42</td>
<td>South Africa</td>
<td>615</td>
<td>[427 – 835]</td>
<td>321.70</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">43</td>
<td>Lesotho</td>
<td>654</td>
<td>[406 – 959]</td>
<td>53.02</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">44</td>
<td>Niger</td>
<td>84</td>
<td>[54 – 120]</td>
<td>11.14</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">45</td>
<td>Eritrea</td>
<td>86</td>
<td>[40 – 151]</td>
<td>4.45</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">46</td>
<td>Mauritania</td>
<td>89</td>
<td>[58 – 127]</td>
<td>22.40</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Now in the joined dataset, we have just the African countries, which is exactly what we wanted.</p>
<p>All rows from the left dataframe <code>tb_2019_africa</code> were kept, while non-African countries from <code>health_exp_2019</code> were discarded.</p>
<p>We can check if any rows in <code>tb_2019_africa</code> did not have a match in <code>health_exp_2019</code> by filtering for <code>NaN</code> values:</p>
<div id="bd8229e7" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>tb_health_exp_joined.query(<span class="st">"expend_usd.isna()"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">cases</th>
<th data-quarto-table-cell-role="th">conf_int_95</th>
<th data-quarto-table-cell-role="th">expend_usd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>Mauritius</td>
<td>12</td>
<td>[9 – 15]</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16</td>
<td>South Sudan</td>
<td>227</td>
<td>[147 – 324]</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26</td>
<td>Comoros</td>
<td>35</td>
<td>[23 – 50]</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>This shows that 3 countries—Mauritius, South Sudan, and Comoros—did not have expenditure data in <code>health_exp_2019</code>. But because they were present in <code>tb_2019_africa</code>, and that was the left dataframe, they were still included in the joined data.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Practice">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practice
</div>
</div>
<section id="practice-q-left-join-tb-cases-and-continents" class="level2 callout-body-container callout-body" data-number="21.12">
<h2 data-number="21.12" class="anchored" data-anchor-id="practice-q-left-join-tb-cases-and-continents"><span class="header-section-number">21.12</span> Practice Q: Left Join TB Cases and Continents</h2>
<p>The first, <code>tb_cases_children</code>, contains the number of TB cases in under 15s in 2012, by country:</p>
<div id="34c4cb68" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>tb_cases_children</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">tb_cases_smear_0_14</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Afghanistan</td>
<td>588.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Albania</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Algeria</td>
<td>89.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>Andorra</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>Angola</td>
<td>982.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">211</td>
<td>Viet Nam</td>
<td>142.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">213</td>
<td>West Bank and Gaza Strip</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">214</td>
<td>Yemen</td>
<td>105.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">215</td>
<td>Zambia</td>
<td>321.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">216</td>
<td>Zimbabwe</td>
<td>293.0</td>
</tr>
</tbody>
</table>

<p>200 rows × 2 columns</p>
</div>
</div>
</div>
<p>And <code>country_continents</code>, lists all countries and their corresponding region and continent:</p>
<div id="c35bfc15" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>country_continents</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country.name.en</th>
<th data-quarto-table-cell-role="th">continent</th>
<th data-quarto-table-cell-role="th">region</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Afghanistan</td>
<td>Asia</td>
<td>South Asia</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Albania</td>
<td>Europe</td>
<td>Europe &amp; Central Asia</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Algeria</td>
<td>Africa</td>
<td>Middle East &amp; North Africa</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>American Samoa</td>
<td>Oceania</td>
<td>East Asia &amp; Pacific</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Andorra</td>
<td>Europe</td>
<td>Europe &amp; Central Asia</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">286</td>
<td>Yugoslavia</td>
<td>NaN</td>
<td>Europe &amp; Central Asia</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">287</td>
<td>Zambia</td>
<td>Africa</td>
<td>Sub-Saharan Africa</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">288</td>
<td>Zanzibar</td>
<td>NaN</td>
<td>Sub-Saharan Africa</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">289</td>
<td>Zimbabwe</td>
<td>Africa</td>
<td>Sub-Saharan Africa</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">290</td>
<td>Åland Islands</td>
<td>Europe</td>
<td>Europe &amp; Central Asia</td>
</tr>
</tbody>
</table>

<p>291 rows × 3 columns</p>
</div>
</div>
</div>
<p>Your goal is to add the continent and region data to the TB cases dataset.</p>
<p>Which dataframe should be the left one? And which should be the right one? Once you’ve decided, join the datasets appropriately using a left join.</p>
</section>
</div>
</section>
<section id="right-join" class="level2" data-number="21.13">
<h2 data-number="21.13" class="anchored" data-anchor-id="right-join"><span class="header-section-number">21.13</span> <code>right</code> join</h2>
<p>A <code>right</code> join can be thought of as a mirror image of a <code>left</code> join. The mechanics are the same, but now all rows from the <em>right</em> dataframe are retained, while only those rows from the left dataframe that find a match in the right are kept.</p>
<p>Let’s look at an example to understand this. We’ll use our original <code>people</code> and modified <code>test_info_xavier</code> datasets:</p>
<div id="85463a00" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>people</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>test_info_xavier</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">test_date</th>
<th data-quarto-table-cell-role="th">result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Alice</td>
<td>2023-06-05</td>
<td>Negative</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Bob</td>
<td>2023-08-10</td>
<td>Positive</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Xavier</td>
<td>2023-05-02</td>
<td>Negative</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Now let’s try a right join, with <code>people</code> as the right dataframe:</p>
<div id="efede55f" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>pd.merge(test_info_xavier, people, on<span class="op">=</span><span class="st">'name'</span>, how<span class="op">=</span><span class="st">'right'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">test_date</th>
<th data-quarto-table-cell-role="th">result</th>
<th data-quarto-table-cell-role="th">age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Alice</td>
<td>2023-06-05</td>
<td>Negative</td>
<td>25</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Bob</td>
<td>2023-08-10</td>
<td>Positive</td>
<td>32</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Charlie</td>
<td>NaN</td>
<td>NaN</td>
<td>45</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Hopefully you’re getting the hang of this and could predict that output! Since <code>people</code> was the <em>right</em> dataframe, and we are using a <em>right</em> join, all the rows from <code>people</code> are kept—Alice, Bob, and Charlie—but only matching records from <code>test_info_xavier</code>.</p>
<p>The graphic below illustrates this process:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/right_join.gif" class="img-fluid figure-img"></p>
<figcaption>Right Join</figcaption>
</figure>
</div>
<p>An important point—the same final dataframe can be created with either a <code>left</code> join or a <code>right</code> join; it just depends on what order you provide the dataframes to these functions:</p>
<div id="004c397d" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here, right join prioritizes the right dataframe, people</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>pd.merge(test_info_xavier, people, on<span class="op">=</span><span class="st">'name'</span>, how<span class="op">=</span><span class="st">'right'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">test_date</th>
<th data-quarto-table-cell-role="th">result</th>
<th data-quarto-table-cell-role="th">age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Alice</td>
<td>2023-06-05</td>
<td>Negative</td>
<td>25</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Bob</td>
<td>2023-08-10</td>
<td>Positive</td>
<td>32</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Charlie</td>
<td>NaN</td>
<td>NaN</td>
<td>45</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="c15a0e0e" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here, left join prioritizes the left dataframe, again people</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>pd.merge(people, test_info_xavier, on<span class="op">=</span><span class="st">'name'</span>, how<span class="op">=</span><span class="st">'left'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">test_date</th>
<th data-quarto-table-cell-role="th">result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Alice</td>
<td>25</td>
<td>2023-06-05</td>
<td>Negative</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Bob</td>
<td>32</td>
<td>2023-08-10</td>
<td>Positive</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Charlie</td>
<td>45</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>As we previously mentioned, data scientists typically favor <code>left</code> joins over <code>right</code> joins. It makes more sense to specify your primary dataset first, in the left position. Opting for a <code>left</code> join is a common best practice due to its clearer logic, making it less error-prone.</p>
</section>
<section id="inner-join" class="level2" data-number="21.14">
<h2 data-number="21.14" class="anchored" data-anchor-id="inner-join"><span class="header-section-number">21.14</span> <code>inner</code> join</h2>
<p>What makes an <code>inner</code> join distinct is that rows are only kept if the joining values are present in <em>both</em> dataframes. Let’s return to our example of individuals and their test results. As a reminder, here are our datasets:</p>
<div id="ea9bf70c" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>people</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Alice</td>
<td>25</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Bob</td>
<td>32</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Charlie</td>
<td>45</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="033a7803" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>test_info_xavier</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">test_date</th>
<th data-quarto-table-cell-role="th">result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Alice</td>
<td>2023-06-05</td>
<td>Negative</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Bob</td>
<td>2023-08-10</td>
<td>Positive</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Xavier</td>
<td>2023-05-02</td>
<td>Negative</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Now that we have a better understanding of how joins work, we can already picture what the final dataframe would look like if we used an <code>inner</code> join on our two dataframes above. If only rows with joining values that are in <em>both</em> dataframes are kept, and the only individuals that are in both <code>people</code> and <code>test_info_xavier</code> are <code>Alice</code> and <code>Bob</code>, then they should be the only individuals in our final dataset! Let’s try it out.</p>
<div id="e1839c2c" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>pd.merge(people, test_info_xavier, on<span class="op">=</span><span class="st">'name'</span>, how<span class="op">=</span><span class="st">'inner'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">test_date</th>
<th data-quarto-table-cell-role="th">result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Alice</td>
<td>25</td>
<td>2023-06-05</td>
<td>Negative</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Bob</td>
<td>32</td>
<td>2023-08-10</td>
<td>Positive</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Perfect, that’s exactly what we expected! Here, <code>Charlie</code> was only in the <code>people</code> dataset, and <code>Xavier</code> was only in the <code>test_info_xavier</code> dataset, so both of them were removed. The graphic below shows how this join works:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/inner_join.gif" class="img-fluid figure-img"></p>
<figcaption>Inner Join</figcaption>
</figure>
</div>
<p>Note that the default join type is <code>inner</code>. So if you don’t specify <code>how='inner'</code>, you’re actually performing an inner join! Try it out:</p>
<div id="3dea5ee5" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>pd.merge(people, test_info_xavier)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">test_date</th>
<th data-quarto-table-cell-role="th">result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Alice</td>
<td>25</td>
<td>2023-06-05</td>
<td>Negative</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Bob</td>
<td>32</td>
<td>2023-08-10</td>
<td>Positive</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Practice">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practice
</div>
</div>
<section id="practice-q-inner-join-products" class="level2 callout-body-container callout-body" data-number="21.15">
<h2 data-number="21.15" class="anchored" data-anchor-id="practice-q-inner-join-products"><span class="header-section-number">21.15</span> Practice Q: Inner Join Products</h2>
<p>The following data is on product sales and customer feedback in 2019.</p>
<div id="46414b31" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>total_sales</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">product</th>
<th data-quarto-table-cell-role="th">total_units_sold</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Laptop</td>
<td>9751</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Desktop</td>
<td>136</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Tablet</td>
<td>8285</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Smartphone</td>
<td>2478</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Smartwatch</td>
<td>3642</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Headphones</td>
<td>5231</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Monitor</td>
<td>1892</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Keyboard</td>
<td>4267</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Mouse</td>
<td>3891</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Printer</td>
<td>982</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="356d8bfc" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>product_feedback</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">product</th>
<th data-quarto-table-cell-role="th">n_positive_reviews</th>
<th data-quarto-table-cell-role="th">n_negative_reviews</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Laptop</td>
<td>1938</td>
<td>42</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Desktop</td>
<td>128</td>
<td>30</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Tablet</td>
<td>842</td>
<td>56</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Smartphone</td>
<td>1567</td>
<td>89</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Smartwatch</td>
<td>723</td>
<td>34</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Headphones</td>
<td>956</td>
<td>28</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Monitor</td>
<td>445</td>
<td>15</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Gaming Console</td>
<td>582</td>
<td>11</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Camera</td>
<td>234</td>
<td>8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Speaker</td>
<td>678</td>
<td>25</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Use an <code>inner</code> join to combine the datasets.</p>
<p>How many products are there in common between the two datasets.</p>
<p>Which product has the highest ratio of positive reviews to units sold? (Should be desktops)</p>
</section>
</div>
</section>
<section id="outer-join" class="level2" data-number="21.16">
<h2 data-number="21.16" class="anchored" data-anchor-id="outer-join"><span class="header-section-number">21.16</span> <code>outer</code> join</h2>
<p>The peculiarity of the <code>outer</code> join is that it retains <em>all</em> records, regardless of whether or not there is a match between the two datasets. Where there is missing information in our final dataset, cells are set to <code>NaN</code> just as we have seen in the <code>left</code> and <code>right</code> joins. Let’s take a look at our <code>people</code> and <code>test_info_xavier</code> datasets to illustrate this.</p>
<p>Here is a reminder of our datasets:</p>
<div id="a1c40ef4" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>people</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>test_info_xavier</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">test_date</th>
<th data-quarto-table-cell-role="th">result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Alice</td>
<td>2023-06-05</td>
<td>Negative</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Bob</td>
<td>2023-08-10</td>
<td>Positive</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Xavier</td>
<td>2023-05-02</td>
<td>Negative</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Now let’s perform an <code>outer</code> join:</p>
<div id="766bdc5a" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>pd.merge(people, test_info_xavier, on<span class="op">=</span><span class="st">'name'</span>, how<span class="op">=</span><span class="st">'outer'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">test_date</th>
<th data-quarto-table-cell-role="th">result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Alice</td>
<td>25.0</td>
<td>2023-06-05</td>
<td>Negative</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Bob</td>
<td>32.0</td>
<td>2023-08-10</td>
<td>Positive</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Charlie</td>
<td>45.0</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Xavier</td>
<td>NaN</td>
<td>2023-05-02</td>
<td>Negative</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>As we can see, all rows were kept so there was no loss in information! The graphic below illustrates this process:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/full_join.gif" class="img-fluid figure-img"></p>
<figcaption>Outer Join</figcaption>
</figure>
</div>
<p>Just as we saw above, all of the data from both of the original dataframes are still there, with any missing information set to <code>NaN</code>.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Practice">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practice
</div>
</div>
<section id="practice-q-join-sales-data" class="level2 callout-body-container callout-body" data-number="21.17">
<h2 data-number="21.17" class="anchored" data-anchor-id="practice-q-join-sales-data"><span class="header-section-number">21.17</span> Practice Q: Join Sales Data</h2>
<p>The following dataframes contain global sales and global customer complaints from various years.</p>
<div id="33800eee" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>sales</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">sales_count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2010</td>
<td>69890</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2011</td>
<td>66507</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2014</td>
<td>59831</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2016</td>
<td>58704</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2017</td>
<td>59151</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="e883ce90" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>customer_complaints</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">complaints_count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2011</td>
<td>1292</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2013</td>
<td>1100</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2015</td>
<td>1011</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2016</td>
<td>940</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2019</td>
<td>895</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Join the above tables using the appropriate join to retain all information from the two datasets.</p>
</section>
</div>
</section>
<section id="wrap-up" class="level2" data-number="21.18">
<h2 data-number="21.18" class="anchored" data-anchor-id="wrap-up"><span class="header-section-number">21.18</span> Wrap Up!</h2>
<p>Way to go, you now understand the basics of joining! The Venn diagram below gives a helpful summary of the different joins and the information that each one retains. It may be helpful to save this image for future reference!</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/venn_cropped-01.jpg" class="img-fluid figure-img"></p>
<figcaption>Join Types</figcaption>
</figure>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./p_untangled_other_grouped_operations.html" class="pagination-link" aria-label="Other Grouped Operations in Pandas">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Other Grouped Operations in Pandas</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./p_untangled_joining_2.html" class="pagination-link" aria-label="Joining 2: One-to-Many, Multi-Key Joins &amp; Key Mismatches">
        <span class="nav-page-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Joining 2: One-to-Many, Multi-Key Joins &amp; Key Mismatches</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Book created by <a href="https://thegraphcourses.org/">The GRAPH Courses</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/the-graph-courses/idap_book/edit/main/p_untangled_joining_1.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/the-graph-courses/idap_book/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>